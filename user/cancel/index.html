
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../drc/">
      
      
        <link rel="next" href="../checksum/">
      
      
      <link rel="icon" href="../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.7">
    
    
      
        <title>Cancelation and Timeouts - Mercury</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4b4a2bd9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","UA-98228964-1"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","UA-98228964-1",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=UA-98228964-1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pre-requisites" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Mercury" class="md-header__button md-logo" aria-label="Mercury" data-md-component="logo">
      
  <img src="../../assets/images/mercury_white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mercury
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cancelation and Timeouts
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/mercury-hpc/mercury" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"/></svg>
  </div>
  <div class="md-source__repository">
    mercury-hpc/mercury
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../releases/download/" class="md-tabs__link">
          
  
  Releases

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../overview/" class="md-tabs__link">
          
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../publications/" class="md-tabs__link">
        
  
    
  
  Publications

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../help/" class="md-tabs__link">
        
  
    
  
  Help

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Mercury" class="md-nav__button md-logo" aria-label="Mercury" data-md-component="logo">
      
  <img src="../../assets/images/mercury_white.png" alt="logo">

    </a>
    Mercury
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mercury-hpc/mercury" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"/></svg>
  </div>
  <div class="md-source__repository">
    mercury-hpc/mercury
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Releases
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Releases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../releases/download/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Download
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Release Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../releases/CHANGES_v2.3.1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes v2.3.1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../releases/CHANGES_v2.3.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes v2.3.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../releases/CHANGES_v2.2.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes v2.2.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../releases/CHANGES_v2.1.0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes v2.1.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../releases/CHANGES_v2.0.1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes v2.0.1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../na/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Abstraction Layer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../hg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mercury RPC Layer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../hg_bulk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mercury Bulk Layer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../hg_macros/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mercury Serialization Macros
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" checked>
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Appendix
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Appendix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ofi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Libfabric Plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shared-Memory Plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../drc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Cray DRC credentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Cancelation and Timeouts
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Cancelation and Timeouts
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pre-requisites" class="md-nav__link">
    Pre-requisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#progress-model" class="md-nav__link">
    Progress model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rpc-cancelation" class="md-nav__link">
    RPC cancelation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-cases" class="md-nav__link">
    Use Cases
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timeouts-and-retries" class="md-nav__link">
    Timeouts and Retries
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cancelation-in-na" class="md-nav__link">
    Cancelation in NA
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    Conclusion
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../checksum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MChecksum Library
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../publications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Publications
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../help/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Help
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Cancelation and Timeouts</h1>

<p>Mercury provides two separate types of transfers: RPC and bulk data. We
present in this page how on-going operations can be canceled and
recovered from a canceled state.</p>
<h2 id="pre-requisites">Pre-requisites</h2>
<p>Mercury has been defined as a building block for distributed services.
In that context, adding support for cancelation of mercury operations
is a primary requirement to provide resiliency and allow services to
recover after a fault has occurred (e.g., node failure, etc). This
implies reclaiming resources that canceled operations have previously
allocated. Mercury defines remote lookup operations as well as two types
of transfer operations, RPC and bulk data transfers, which may be
interrupted if any of the party involved no longer responds or reaches a
time of <em>no response</em> (e.g., on process termination), in which case
pending operations must be canceled. Canceling an operation that cannot
complete, either because a fault has occurred or a timeout has been
reached, is necessary in order to reach proper completion.</p>
<p>This documentation assumes that the reader already has knowledge of Mercury
and its layers (NA / HG / HG Bulk).</p>
<h2 id="progress-model">Progress model</h2>
<p>Mercury uses a callback-based mechanism that is
built on top of the network abstraction (NA) layer’s callback mechanism.
A callback mechanism presents two advantages compared to a traditional
request based model: there is no explicit <code>wait()</code> control point;
cancelation of operations can be easily done without any additional
code branching.</p>
<p>Mercury’s progress is directly driven by NA’s progress. When an NA
operation completes, an internal callback is pushed to the NA’s
completion queue. To make progress on Mercury’s operations, the Mercury
layer also internally triggers these NA callback operations. Triggering
NA operations may in turn result in the completion of Mercury
operations. When these operations complete, the user callback that is
associated with these operations is in turn pushed to a completion
queue.</p>
<p>RPC operations are associated with a <em>handle</em> that is explicitly created
by the user and linked to an execution target. The forward call is
passed the handle along with a structure holding the input arguments,
serializes input arguments, and passes the RPC parameters to the target.
On completion, the user callback passed to the forward call is pushed to
a completion queue. When an RPC forward operation completes, the <em>get
output</em> call is passed that same handle to retrieve output arguments,
deserializes them. Note that the handle can be safely re-used after
completion (or cancelation) to issue another RPC to the same target.
When the user no longer needs to operate on a given handle, it can be
explicitly destroyed; a reference count provides operation safety.</p>
<h2 id="rpc-cancelation">RPC cancelation</h2>
<p>In that context, Mercury’s RPC cancelation can be defined so that:</p>
<ul>
<li>No explicit tracking of handles is required (user calls
    <code>HG_Destroy()</code>).</li>
<li>User callbacks are pushed to the completion queue with a canceled
    state.</li>
<li>Canceled handles can be reused to retry to forward a call to a
    target.</li>
</ul>
<p>When cancelation is done on an HG operation, cancelation is also done
internally on the NA operations that were involved in that HG operation.
When this cancelation is successful and the NA operations complete with
a canceled state, the HG callbacks associated to the NA operations are
pushed to the completion queue. When these callbacks are executed with a
canceled state, the actual HG operation is successfully canceled and the
state of the operation passed to the callback function indicates that
the operation was canceled.</p>
<div class="admonition warning">
<p class="admonition-title">Warning<p>It is important to note that cancelation is always <em>local</em>, in the
sense that there is no communication involved with a remote party (i.e.,
it does not rely on the remote party being able to communicate).</p>
</p>
</div>
<p>It is also worth noting that the main focus of our implementation of
mercury’s RPC cancelation is the recovery from faults, and not the
support of RPC transfer scenarios that rely on cancelation (e.g.,
optimistic queries in a data service, or higher level protocol
operations, which could theoretically also be supported).</p>
<p>Xancelation can be supported for the following operations:
-   <code>HG_Forward()</code>, <code>HG_Respond()</code> (RPC operations)
-   <code>HG_Bulk_transfer()</code> (Bulk operations)</p>
<p>We define the following calls:</p>
<ul>
<li>
<p>RPC operations:
    <div class="highlight"><pre><span></span><code><span class="w">    </span><span class="n">hg_return_t</span><span class="w"> </span><span class="nf">HG_Cancel</span><span class="p">(</span><span class="n">hg_handle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span>
</code></pre></div></p>
</li>
<li>
<p>Bulk operations:
    <div class="highlight"><pre><span></span><code><span class="w">    </span><span class="n">hg_return_t</span><span class="w"> </span><span class="nf">HG_Bulk_cancel</span><span class="p">(</span><span class="n">hg_op_id_t</span><span class="w"> </span><span class="n">op_id</span><span class="p">);</span>
</code></pre></div></p>
</li>
</ul>
<h2 id="use-cases">Use Cases</h2>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p><em>Cancelation of an RPC operation without bulk transfer involved</em></p>
<p>In the case described below, a handle is created and forwarded to a
target. After reaching timeout, the current operation referenced by the
handle is canceled. The <code>forward_cb</code> user callback is pushed to the
context’s completion queue with a canceled return state.</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">hg_return_t</span>
<span class="nf">forward_cb</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">hg_cb_info</span><span class="w"> </span><span class="o">*</span><span class="n">cb_info</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cb_info</span><span class="o">-&gt;</span><span class="n">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HG_CANCELED</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/* Canceled */</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cb_info</span><span class="o">-&gt;</span><span class="n">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HG_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/* Sucessfully executed */</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">hg_handle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* Create new HG handle */</span>
<span class="w">    </span><span class="n">HG_Create</span><span class="p">(</span><span class="n">hg_context</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">rpc_id</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">hg_handle</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Encode RPC */</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="cm">/* Forward call */</span>
<span class="w">    </span><span class="n">HG_Forward</span><span class="p">(</span><span class="n">hg_handle</span><span class="p">,</span><span class="w"> </span><span class="n">forward_cb</span><span class="p">,</span><span class="w"> </span><span class="n">forward_cb_args</span><span class="p">,</span><span class="w"> </span><span class="n">in_struct</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* No progress after timeout */</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="cm">/* Cancel operation */</span>
<span class="w">    </span><span class="n">HG_Cancel</span><span class="p">(</span><span class="n">hg_handle</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Trigger user callback */</span>
<span class="w">    </span><span class="n">HG_Trigger</span><span class="p">(</span><span class="n">hg_context</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Destroy handle */</span>
<span class="w">    </span><span class="n">HG_Destroy</span><span class="p">(</span><span class="n">hg_handle</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p><em>Cancelation of an RPC operation with bulk transfer involved</em></p>
<p>In that case, the RPC operation additionally involves a bulk transfer
that is initiated by a remote target. A bulk handle that describes the
memory region is first created and registered to the NIC. This bulk
handle is then serialized along with the RPC arguments, thereby
exposing/publishing the memory region to the target. The RPC handle is
similarly forwarded to the target. After reaching timeout, the handle is
canceled. The <code>forward_cb</code> user callback is pushed to the context’s
completion queue with a canceled return state.</p>
<p>It is worth noting that when the RPC operation is canceled, the target
may be in the process of accessing the exposed bulk region. To guarantee
prevention of further remote accesses to the region involved in the bulk
transfer, the bulk transfer must be separately destroyed and unpublished
(note that this guaranty is only valid if the underlying NA plugin
supports it). The bulk handle is part of the input data structure and
can be referenced within the RPC handle callback function for the
purpose of separately canceling the remote bulk operation.</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">hg_return_t</span>
<span class="nf">forward_cb</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">hg_cb_info</span><span class="w"> </span><span class="o">*</span><span class="n">cb_info</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cb_info</span><span class="o">-&gt;</span><span class="n">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HG_CANCELED</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/* Canceled */</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cb_info</span><span class="o">-&gt;</span><span class="n">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HG_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/* Sucessfully executed */</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">hg_handle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">;</span>
<span class="w">    </span><span class="n">hg_bulk_t</span><span class="w"> </span><span class="n">bulk_handle</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* Create new HG bulk handle */</span>
<span class="w">    </span><span class="n">HG_Bulk_create</span><span class="p">(</span><span class="n">hg_class</span><span class="p">,</span><span class="w"> </span><span class="n">buffer_ptrs</span><span class="p">,</span><span class="w"> </span><span class="n">buffer_sizes</span><span class="p">,</span>
<span class="w">                </span><span class="o">&amp;</span><span class="n">hg_bulk_handle</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Create new HG handle */</span>
<span class="w">    </span><span class="n">HG_Create</span><span class="p">(</span><span class="n">hg_context</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">rpc_id</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">hg_handle</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Encode RPC and bulk handle */</span>
<span class="w">    </span><span class="n">in_struct</span><span class="p">.</span><span class="n">bulk_handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bulk_handle</span><span class="p">;</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="cm">/* Forward call */</span>
<span class="w">    </span><span class="n">HG_Forward</span><span class="p">(</span><span class="n">hg_handle</span><span class="p">,</span><span class="w"> </span><span class="n">forward_cb</span><span class="p">,</span><span class="w"> </span><span class="n">forward_cb_args</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">in_struct</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* No progress after timeout */</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="cm">/* Cancel operation */</span>
<span class="w">    </span><span class="n">HG_Cancel</span><span class="p">(</span><span class="n">hg_handle</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Trigger user callback */</span>
<span class="w">    </span><span class="n">HG_Trigger</span><span class="p">(</span><span class="n">hg_context</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Destroy HG handle */</span>
<span class="w">    </span><span class="n">HG_Destroy</span><span class="p">(</span><span class="n">hg_handle</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Destroy HG bulk handle */</span>
<span class="w">    </span><span class="n">HG_Bulk_destroy</span><span class="p">(</span><span class="n">hg_bulk_handle</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p><em>Cancelation of a bulk operation</em></p>
<p>Bulk cancelation follows a similar model. However, bulk operations are
initiated by an RPC target, not by the origin. Bulk operations are
identified by an operation ID, which gets freed when the bulk callback
is executed.</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">hg_return_t</span>
<span class="nf">bulk_cb</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">hg_cb_info</span><span class="w"> </span><span class="o">*</span><span class="n">cb_info</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cb_info</span><span class="o">-&gt;</span><span class="n">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HG_CANCELED</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/* Canceled */</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cb_info</span><span class="o">-&gt;</span><span class="n">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HG_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/* Sucessfully executed */</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="n">hg_return_t</span>
<span class="nf">rpc_cb</span><span class="p">(</span><span class="n">hg_handle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">hg_bulk_t</span><span class="w"> </span><span class="n">origin_handle</span><span class="p">,</span><span class="w"> </span><span class="n">local_handle</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* Setup handles etc */</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="cm">/* Start the transfer */</span>
<span class="w">    </span><span class="n">HG_bulk_transfer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">bulk_cb</span><span class="p">,</span><span class="w"> </span><span class="n">bulk_cb_args</span><span class="p">,</span><span class="w"> </span><span class="n">HG_BULK_PULL</span><span class="p">,</span>
<span class="w">                    </span><span class="n">origin_addr</span><span class="p">,</span><span class="w"> </span><span class="n">origin_handle</span><span class="p">,</span><span class="w"> </span><span class="n">origin_offset</span><span class="p">,</span>
<span class="w">                    </span><span class="n">local_handle</span><span class="p">,</span><span class="w"> </span><span class="n">local_offset</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">op_id</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* No progress after timeout */</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="cm">/* Cancel operation */</span>
<span class="w">    </span><span class="n">HG_Bulk_cancel</span><span class="p">(</span><span class="n">op_id</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Trigger user callback */</span>
<span class="w">    </span><span class="n">HG_Trigger</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h2 id="timeouts-and-retries">Timeouts and Retries</h2>
<p>Mercury does not currently support timeouts on operations because this
would require tracking handles / operation IDs, which could lead to
unnecessary overheads within the Mercury layer. For cases where a
timeout is desired, the application can wrap around Mercury calls. The
example below shows how one can use the HG request emulation library to
issue an RPC call with timeout.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">hg_return_t</span>
<span class="nf">forward_cb</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">hg_cb_info</span><span class="w"> </span><span class="o">*</span><span class="n">cb_info</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">hg_request_t</span><span class="w"> </span><span class="o">*</span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">hg_request_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">cb_info</span><span class="o">-&gt;</span><span class="n">arg</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cb_info</span><span class="o">-&gt;</span><span class="n">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HG_CANCELED</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/* Canceled */</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cb_info</span><span class="o">-&gt;</span><span class="n">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HG_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/* Sucessfully executed */</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">hg_request_complete</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">hg_handle_t</span><span class="w"> </span><span class="n">handle</span><span class="p">;</span>
<span class="w">    </span><span class="n">hg_request_t</span><span class="w"> </span><span class="o">*</span><span class="n">request</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* Create new HG handle */</span>
<span class="w">    </span><span class="n">HG_Create</span><span class="p">(</span><span class="n">hg_context</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">rpc_id</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">hg_handle</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Encode RPC */</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="cm">/* Create new request */</span>
<span class="w">    </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hg_request_create</span><span class="p">(</span><span class="n">request_class</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Forward call */</span>
<span class="w">    </span><span class="n">HG_Forward</span><span class="p">(</span><span class="n">hg_handle</span><span class="p">,</span><span class="w"> </span><span class="n">forward_cb</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">in_struct</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Wait for completion */</span>
<span class="w">    </span><span class="n">hg_request_wait</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">completed</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">completed</span><span class="p">)</span>
<span class="w">        </span><span class="n">HG_Cancel</span><span class="p">(</span><span class="n">hg_handle</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Wait for completion */</span>
<span class="w">    </span><span class="n">hg_request_wait</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">completed</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Destroy request */</span>
<span class="w">    </span><span class="n">hg_request_destroy</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Destroy handle */</span>
<span class="w">    </span><span class="n">HG_Destroy</span><span class="p">(</span><span class="n">hg_handle</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h2 id="cancelation-in-na">Cancelation in NA</h2>
<p>Cancelation of HG operations can only be realized by first supporting
cancelation at the NA layer. Cancelation is supported via the
following call:</p>
<div class="highlight"><pre><span></span><code><span class="n">na_return_t</span>
<span class="nf">NA_Cancel</span><span class="p">(</span><span class="n">na_class_t</span><span class="w"> </span><span class="o">*</span><span class="n">na_class</span><span class="p">,</span><span class="w"> </span><span class="n">na_context_t</span><span class="w"> </span><span class="o">*</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">na_op_id_t</span><span class="w"> </span><span class="n">op_id</span><span class="p">);</span>
</code></pre></div>
<p>An additional <code>cancel</code> callback is added to the NA layer that allows
plugin developers to support cancelation of non-blocking operations.
These include:</p>
<ul>
<li><code>NA_Msg_send_unexpected()</code>, <code>NA_Msg_recv_unexpected()</code></li>
<li><code>NA_Msg_send_expected()</code>, <code>NA_Msg_recv_expected()</code></li>
<li><code>NA_Put()</code>, <code>NA_Get()</code></li>
</ul>
<p>Cancelation of NA operations is internally progressed and actually
completes when internal plugin cancelation has been successfully
completed (which may or may not be immediate). When an NA operation is
successfully canceled, the internal callback associated to the HG
operation is placed onto the NA context’s completion queue with a
<code>NA_CANCELED</code> return state.</p>
<p>Cancelation is supported for all plugins. It is worth
noting that BMI and MPI emulate one-sided operations (<code>NA_Put()</code>,
<code>NA_Get()</code>) on top of two-sided operations and cancelation for these
operations is not yet supported. To emulate these operations, send/recv
requests are sent to the remote target which may issue a send in the
case of a get, or issue a recv in the case of a put. Cancelation of
these operations implies cancelation at the target of the potentially
issued send/recv operations, which can only be done using timeouts
(remote notification not being an option because the caller has no
guaranty that the target is still alive).</p>
<p>Cancelation capabilities and execution scenarios where cancelation is
supported (i.e., not only for fault tolerance) only depend on the
underlying NA plugins and their capabilities to support cancelation of
on-going transfers. The BMI plugin for example may not recover well from
cancelation of transfers when using TCP and a rendez-vous protocol, as
the TCP channel must be entirely flushed before one can do further
communication. This may be compromising if other operations were also in
the pipe at that time as these operations may consequently fail.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Adding cancelation to mercury is an important step for building
resilient services and a required component for the definition of future
high-level mercury features such as group membership and pub/sub
services, where fault tolerance must be considered in order to prevent
collective failure.</p>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">December 4, 2021</span>
      
    
  </small>
</div>


  




                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2013 - 2022 UChicago Argonne, LLC and The HDF Group, Copyright &copy; 2022 - 2023 Intel Corporation
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "toc.integrate"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
    
  </body>
</html>